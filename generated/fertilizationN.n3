@base <https://agriculture.ld.admin.ch/agroscope/> .
@prefix : <https://agriculture.ld.admin.ch/prif/> .
@prefix calc: <https://agriculture.ld.admin.ch/prif/calc#> .
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix math: <http://www.w3.org/2000/10/swap/math#> .
@prefix cube: <https://cube.link/> .
@prefix qudt: <http://qudt.org/schema/qudt/> .
@prefix unit: <http://qudt.org/vocab/unit/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix schema: <http://schema.org/> .

{
    
        :fertilizationNorm rdf:value ?fertilizationNorm .

        :aa rdf:value ?aa .
    (?fertilizationNorm ?aa ) math:sum ?test .
}
=>
{
    :test rdf:value ?test ;
        a calc:Sum ;
        calc:summand :fertilizationNorm, :aa .
} .
{
    <PRIFm8t9c/3> cube:observationSet [ cube:observation ?obs ] .
    ?obs <PRIFm8t9c/fertilizationnormkgha> ?fertilizationNorm .
}
=>
{
    :fertilizationNorm
        rdf:value ?fertilizationNorm ;
        qudt:unit unit:KiloGM-PER-HA ;
        calc:source ?obs .
} .
{
    <PRIFm8t9a/4> cube:observationSet [ cube:observation ?obs ] .
    ?obs <PRIFm8t9a/referenceyielddtha> ?referenceYield .
    ?obs <PRIFm8t9a/producttype> "mainProduct" .
}
=>
{
    :referenceYield
        rdf:value ?referenceYield ;
        qudt:unit unit:DeciTONNE-PER-HA ;
        calc:source ?obs .
} .
{
    
}
=>
{
    :aa rdf:value 10 .
} .
{
    :aa rdf:value ?bb .
}
=>
{
    :bb rdf:value ?bb .
} .
{
    
        :aa rdf:value ?aa .

        :bb rdf:value ?bb .
    (?aa ?bb ) math:sum ?cc .
}
=>
{
    :cc rdf:value ?cc ;
        a calc:Sum ;
        calc:summand :aa, :bb .
} .
{
    # aa < 10
    :aa rdf:value ?aa .
    ?aa math:lessThan 10 .
    
    
        :cc rdf:value ?cc .

        :aa rdf:value ?aa .
    (?cc ?aa ) math:sum ?result .
}
=>
{
    :result calc:condition "aa < 10" .
    :result rdf:value ?result ;
        a calc:Sum ;
        calc:summand :cc, :aa .
} .

{
    [] log:notIncludes { :result calc:condition "aa < 10" } .
    # aa = 10
    :aa rdf:value ?aa .
    ?aa math:equalTo 10 .
    
    
}
=>
{
    :result calc:condition "aa = 10" .
    :result rdf:value 3 .
} .
